<!DOCTYPE html>
<html lang="fr" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation - Vérification OPSEC Loader</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-10 offset-md-1">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                        <h2 class="mb-0">Documentation OPSEC Loader</h2>
                        <div class="d-flex align-items-center">
                            <div class="theme-switch-wrapper me-3">
                                <i class="bi bi-moon-fill theme-icon theme-icon-moon"></i>
                                <label class="theme-switch">
                                    <input type="checkbox" id="theme-switch">
                                    <span class="slider"></span>
                                </label>
                                <i class="bi bi-sun-fill theme-icon theme-icon-sun"></i>
                            </div>
                            <a href="{{ url_for('index') }}" class="btn btn-outline-light">Retour</a>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h4>Avertissement</h4>
                            <p>Cette application est conçue uniquement à des fins éducatives pour démontrer les limitations des solutions antivirus et EDR modernes. <strong>Aucun code malveillant n'est exécuté</strong> durant les tests.</p>
                        </div>
                        
                        <h3>Le Framework OPSEC Loader</h3>
                        <p>Le framework OPSEC Loader est un ensemble d'outils avancés conçus pour démontrer les limites des solutions de sécurité modernes. À des fins purement éducatives, il illustre comment certaines techniques peuvent contourner les systèmes de détection. Cette application analyse les composants sans exécuter de code malveillant.</p>
                        
                        <div class="row mt-4">
                            <div class="col-md-12 mb-4">
                                <div class="card">
                                    <div class="card-header bg-secondary text-white">
                                        <h4 class="mb-0">Composants principaux du framework</h4>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="card mb-3">
                                                    <div class="card-header bg-primary text-white">
                                                        <h5 class="mb-0">custom_pe2sc.py</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <p>Convertisseur PE vers Shellcode avec techniques d'évasion avancées</p>
                                                        <ul>
                                                            <li>Transforme les exécutables PE en shellcode position-indépendant</li>
                                                            <li>Utilise un encodage polymorphique pour éviter les signatures</li>
                                                            <li>Implémente 4 méthodes d'encodage différentes :
                                                                <ul>
                                                                    <li>XOR avec clé rotative</li>
                                                                    <li>ADD/SUB avec table de sauts</li>
                                                                    <li>NOT + XOR + ROL</li>
                                                                    <li>Encodage basé sur position + delta</li>
                                                                </ul>
                                                            </li>
                                                            <li>Génère automatiquement des stubs d'assembleur fonctionnels</li>
                                                            <li>Intègre un chargeur réflectif complet</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="card mb-3">
                                                    <div class="card-header bg-primary text-white">
                                                        <h5 class="mb-0">encrypt_shell.py</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <p>Module de chiffrement pour shellcode avec multiples algorithmes</p>
                                                        <ul>
                                                            <li>Supporte plusieurs méthodes de chiffrement :
                                                                <ul>
                                                                    <li>AES-256-CBC (mode par défaut)</li>
                                                                    <li>AES-128-CBC (plus rapide)</li>
                                                                    <li>XOR (simple mais détectable)</li>
                                                                </ul>
                                                            </li>
                                                            <li>Génération de clés cryptographiques sécurisées</li>
                                                            <li>Exportation en différents formats (binaire, C/C++, Python)</li>
                                                            <li>Compatible avec les techniques anti-sandboxing</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="card mb-3">
                                                    <div class="card-header bg-primary text-white">
                                                        <h5 class="mb-0">havoc_to_shellcode.py</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <p>Script de compatibilité pour workflows existants</p>
                                                        <ul>
                                                            <li>Assure la compatibilité avec d'anciens scripts</li>
                                                            <li>Intègre des fonctions de modification pour casser les signatures</li>
                                                            <li>Exécute les processus sans traces identifiables</li>
                                                            <li>Sert de pont entre différents outils du framework</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-header bg-primary text-white">
                                                        <h5 class="mb-0">key_formatter_.py</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <p>Utilitaire de formatage de clés cryptographiques</p>
                                                        <ul>
                                                            <li>Génère des clés sans métadonnées identifiables</li>
                                                            <li>Supporte différents formats de sortie :
                                                                <ul>
                                                                    <li>C/C++ (tableaux d'octets)</li>
                                                                    <li>Python (bytearrays)</li>
                                                                    <li>Hexadécimal brut</li>
                                                                    <li>Base64 (pour transmission)</li>
                                                                </ul>
                                                            </li>
                                                            <li>Validation et nettoyage des clés</li>
                                                            <li>Extraction depuis fichiers existants</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header bg-secondary text-white">
                                        <h4 class="mb-0">Fonctionnalités vérifiées</h4>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">
                                                <h5>Conversion PE-to-Shellcode</h5>
                                                <p>Vérifie la présence et les fonctionnalités des outils de conversion de fichiers PE en shellcode position-indépendant, incluant le reflective loading et l'analyse d'en-têtes PE.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>Encodage polymorphique</h5>
                                                <p>Teste les algorithmes d'encodage variables qui génèrent des signatures différentes à chaque exécution pour éviter la détection par patterns.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>Chiffrement multi-couche</h5>
                                                <p>Analyse les méthodes de chiffrement AES-256-CBC, AES-128-CBC et XOR utilisées pour protéger le shellcode et prévenir l'analyse statique.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>Injection mémoire avancée</h5>
                                                <p>Vérifie les techniques d'exécution directe en mémoire avec modification des protections (RW→RX) et allocation en plusieurs étapes.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>Anti-analyse dynamique</h5>
                                                <p>Identifie les techniques utilisées pour détecter les environnements d'analyse comme les sandboxes, les VM et les débogueurs.</p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header bg-secondary text-white">
                                        <h4 class="mb-0">Workflow complet</h4>
                                    </div>
                                    <div class="card-body">
                                        <ol class="list-group list-group-numbered">
                                            <li class="list-group-item">
                                                <h5>1. Préparation du binaire PE</h5>
                                                <p>Sélection ou création d'un exécutable Windows (PE) pour la conversion.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>2. Conversion PE-to-Shellcode</h5>
                                                <p>Conversion du PE en shellcode avec <code>custom_pe2sc.py</code>. Cette étape transforme le code en position-indépendant et applique un encodage polymorphique.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>3. Chiffrement du shellcode</h5>
                                                <p>Utilisation de <code>encrypt_shell.py</code> pour chiffrer le shellcode avec AES-256-CBC ou autre méthode. Les clés sont générées ou fournies par <code>key_formatter_.py</code>.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>4. Génération du loader</h5>
                                                <p>Création d'un loader dans le langage cible (C, C++ ou Python) qui contient les routines de déchiffrement et d'exécution mémoire.</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>5. Obfuscation du loader</h5>
                                                <p>Application de techniques d'obfuscation pour rendre le loader plus difficile à analyser (junk code, string encryption, API hashing).</p>
                                            </li>
                                            <li class="list-group-item">
                                                <h5>6. Exécution sécurisée</h5>
                                                <p>Le loader déchiffre le shellcode, l'injecte en mémoire, et exécute le PE original sans jamais l'écrire sur le disque.</p>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mt-3">
                            <div class="card-header bg-secondary text-white">
                                <h4 class="mb-0">Techniques d'évasion démontrées</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h5>Techniques de chargement</h5>
                                        <ul>
                                            <li>Reflective loading personnalisé</li>
                                            <li>Allocation mémoire en plusieurs étapes</li>
                                            <li>Protection mémoire progressive (RW → RX)</li>
                                            <li>Exécution via thread dédié</li>
                                        </ul>
                                        
                                        <h5>Obfuscation et encodage</h5>
                                        <ul>
                                            <li>Encodage polymorphique</li>
                                            <li>Junk code et modification des patterns</li>
                                            <li>API hashing pour éviter les chaînes</li>
                                            <li>XOR avec clés variables</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h5>Pourquoi les antivirus échouent?</h5>
                                        <ul>
                                            <li>Détection basée sur des signatures statiques</li>
                                            <li>Incapacité à analyser le code chiffré</li>
                                            <li>Difficultés avec les techniques polymorphiques</li>
                                            <li>Temps d'analyse limité pour les comportements</li>
                                        </ul>
                                        
                                        <h5>Leçons pour la sécurité</h5>
                                        <ul>
                                            <li>Ne pas faire confiance uniquement aux antivirus</li>
                                            <li>Importance de la sécurité multicouche</li>
                                            <li>Valeur des solutions de détection comportementale</li>
                                            <li>Ne jamais exécuter des fichiers de sources non vérifiées</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-4">
                            <h5>Rappel important</h5>
                            <p>Ce projet est strictement éducatif. Les techniques présentées sont connues des chercheurs en sécurité et des développeurs d'antivirus. Le but est d'améliorer la compréhension des faiblesses actuelles pour encourager le développement de meilleures défenses.</p>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="d-grid gap-2">
                            <a href="{{ url_for('index') }}" class="btn btn-primary">Retour à l'accueil</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
</body>
</html>